<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">

<head>
	<!-- Mobile Specific Meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon-->
	<link rel="shortcut icon" href="img/fav.png">
	<!-- Author Meta -->
	<meta name="author" content="codepixer">
	<!-- Meta Description -->
	<meta name="description" content="">
	<!-- Meta Keyword -->
	<meta name="keywords" content="">
	<!-- meta character set -->
	<meta charset="UTF-8">
	<!-- Site Title -->
	<title>Educature Education</title>
	<div th:replace="common/common_head::common_head"></div>
	<style>
		.header-scrolled {
			background: #358ab9 !important;
			transition: all 0.5s;
		}
		.form-control {
			width: 40%;
		}
		.show {
			display: block;
			-webkit-animation-name: fadeIn; /*动画名称*/
			-webkit-animation-duration: 1.5s; /*动画持续时间*/
			-webkit-animation-iteration-count: 1; /*动画次数*/
			-webkit-animation-delay: 0s; /*延迟时间*/
		}

		form {display: none;}

		.btn {width: 200px;}

		input {background: #39CECA !important;border: 1px solid yellow !important;}

		.submitSpan {padding: 5px 0 5px 50px;display: inline-block;}

		.submitSpan > img {width: 30px;}

		ul{display: inline-block;}

		.viewer_3Dmoljs{display: inline-block;float: right;}

		#3DStruct{height: 400px; width: 400px; position: relative;}

		.abc{height: 200px; width: 200px; position: relative;margin: auto}

		td{
			vertical-align:middle!important;
		}
		td a{
			line-height: 200px;
		}
		.showd{display: inline-block;float: left;}

		#showStruct{display: none;}

		.showimg{display: inline-block;width: 400px;height: 400px;}

		label{width: 100px}

		textarea{height: 60px;border-radius: 5px}

		#checkdiv label{
			min-width: 115px;
		}

		@media (min-width: 992px){
			.col-lg-8 {flex: 0 0 80%;max-width: 80%;}
		}
	</style>
</head>

<body>

<!-- Start Header Area -->
<header id="header">
	<div class="container">
		<div class="row align-items-center justify-content-between d-flex">
			<div id="logo">
				<a href="/"><img src="img/logo.png" style="width: 250px" alt="" title=""/></a>
			</div>
			<nav id="nav-menu-container">
				<ul class="nav-menu" style="display: none">
					<li class="menu-active"><a href="/">Home</a></li>
					<li><a href="about.html">About</a></li>
					<li><a href="courses.html">Documentation</a></li>
					<li class="menu-has-children"><a href="">Pages</a>
						<ul>
							<li><a href="elements.html">Elements</a></li>
						</ul>
					</li>
					<li class="menu-has-children"><a href="">Blog</a>
						<ul>
							<li><a href="blog-home.html">Blog Home</a></li>
							<li><a href="blog-single.html">Blog Details</a></li>
						</ul>
					</li>
					<li><a href="contact.html">Contact</a></li>
				</ul>
			</nav><!-- #nav-menu-container -->
		</div>
	</div>
</header>
<!-- End Header Area -->


<!-- Start Banner Area -->
<section class="home-banner-area relative">
	<div class="container">
		<div class="row fullscreen d-flex align-items-center justify-content-center">
			<div class="banner-content col-lg-8 col-md-12">
				<h1 style="margin-top: 150px" class="wow fadeIn" data-wow-duration="4s">RNA 3D结构预测服务平台</h1>
				<div class="input-wrap">
					<section class="main">
						<div class="wrapper-demo">
							<form class="form-horizontal submitForm" style="display: block">
								<div class="form-group">
									<label>PdbID:</label>
									<textarea type="text" class="form-control" name="PdbID" placeholder=""></textarea>
								</div>
								<div class="form-group">
									<label>Sequence:</label>
									<textarea type="text" class="form-control" name="Sequence" placeholder=""></textarea>
								</div>
								<div class="form-group">
									<label>2D Strcuture:</label>
									<textarea type="text" class="form-control" name="Strcuture" placeholder=""></textarea>
								</div>
								<div>请勾选要进行预测的方法：</div>
								<div id="checkdiv">
									<label class="checkbox-inline">
										<input type="checkbox" id="inlineCheckbox1" value="option1">MC-Fold
									</label>
									<label class="checkbox-inline">
										<input type="checkbox" id="inlineCheckbox2" value="option2">Vfold3D
									</label>
									<label class="checkbox-inline">
										<input type="checkbox" id="inlineCheckbox3" value="option3">RNAComposer
									</label>
									<label class="2222">
										<input type="checkbox" id="inlineCheckbox4" value="option4">3DRNA
									</label>
								</div>
								<button type="button" class="btn btn-success btn-submit">Submit</button>
							</form>
						</div>
					</section>
					</div>
					<div id="showStruct1" style="width: 100%">
<!--						<a>下载预测文件</a><a>预览</a>-->
<!--						<div class="showd" style="display: none"><img id="2Dimg" class="showimg"></div>-->
<!--						&lt;!&ndash;                        <div id="3DStruct" style="height: 400px; width: 400px; position: relative;" class='viewer_3Dmoljs' data-href ='' data-backgroundcolor='0xffffff' data-style='stick'></div>&ndash;&gt;-->
<!--						<div id="3DStruct" class="abc"></div>-->
						<table class="table">
							<!-- On rows -->
							<!-- On cells (`td` or `th`) -->
							<thead>
							<tr>
								<th>方法</th>
								<th>3D结构</th>
								<th>预览</th>
								<th>下载</th>
								<th>RMSD</th>
							</tr>
							</thead>
							<tr id="mctr">
								<td class="way" >MC-Fold</td>
								<td class="struct"><div id="3DStructMC" class="abc"></div></td>
								<td><a class="prview" target="_blank" href="">预览</a></td>
								<td><a class="download" href="">下载</a></td>
								<td class="rmsd" valign="middle"></td>
							</tr>
							<tr id="vftr">
								<td class="way">Vfold3D</td>
								<td class="struct"><div id="3DStructVF" class="abc"></div></td>
								<td><a class="prview" target="_blank" href="">预览</a></td>
								<td><a class="download" href="">下载</a></td>
								<td class="rmsd" valign="middle"></td>
							</tr>
							<tr id="rtr">
								<td class="way">RNAComposer</td>
								<td class="struct"><div id="3DStructR" class="abc"></div></td>
								<td><a class="prview" target="_blank" href="">预览</a></td>
								<td><a class="download" href="">下载</a></td>
								<td class="rmsd" valign="middle"></td>
							</tr>
							<tr id="3dtr">
								<td class="way">3DRNA</td>
								<td class="struct"><div id="3DStruct3d" class="abc"></div></td>
								<td><a class="prview" target="_blank" href="">预览</a></td>
								<td><a class="download" href="">下载</a></td>
								<td class="rmsd" valign="middle"></td>
							</tr>
						</table>
					</div>
				</div>
			</div>
		</div>

	</div>
	<!--    <div class="rocket-img">-->
	<!--        <img src="img/rocket.png" alt="">-->
	<!--    </div>-->
</section>
<!-- End Banner Area -->
<!-- Start Footer Area -->
<footer class="footer-area section-gap">
	<div class="container">
		<div class="row">
			<div class="col-lg-2 col-md-6 single-footer-widget" >
<!--				<h4></h4>-->
<!--				<ul>-->
<!--					<li><a href="#">Managed Website</a></li>-->
<!--					<li><a href="#">Manage Reputation</a></li>-->
<!--					<li><a href="#">Power Tools</a></li>-->
<!--					<li><a href="#">Marketing Service</a></li>-->
<!--				</ul>-->
			</div>
			<div class="col-lg-2 col-md-6 single-footer-widget">
				<h4>Quick Links</h4>
				<ul>
					<li><a href="#">MC-Fold</a></li>
					<li><a href="#">VFold</a></li>
					<li><a href="#">RNAComposer</a></li>
					<li><a href="#">3DRNA</a></li>
				</ul>
			</div>
			<div class="col-lg-2 col-md-6 single-footer-widget">
<!--				<h4>Features</h4>-->
<!--				<ul>-->
<!--					<li><a href="#">Jobs</a></li>-->
<!--					<li><a href="#">Brand Assets</a></li>-->
<!--					<li><a href="#">Investor Relations</a></li>-->
<!--					<li><a href="#">Terms of Service</a></li>-->
<!--				</ul>-->
			</div>
			<div class="col-lg-2 col-md-6 single-footer-widget">
<!--				<h4>Resources</h4>-->
<!--				<ul>-->
<!--					<li><a href="#">Guides</a></li>-->
<!--					<li><a href="#">Research</a></li>-->
<!--					<li><a href="#">Experts</a></li>-->
<!--					<li><a href="#">Agencies</a></li>-->
<!--				</ul>-->
			</div>
			<div class="col-lg-4 col-md-6 single-footer-widget">
<!--				<h4>Newsletter</h4>-->
<!--				<p>You can trust us. we only send promo offers,</p>-->
<!--				<div class="form-wrap" id="mc_embed_signup">-->
<!--					<form target="_blank"-->
<!--						  action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"-->
<!--						  method="get" class="form-inline">-->
<!--						<input class="form-control" name="EMAIL" placeholder="Your Email Address"-->
<!--							   onfocus="this.placeholder = ''" onblur="this.placeholder = 'Your Email Address '"-->
<!--							   required="" type="email">-->
<!--						<button class="click-btn btn btn-default"><span class="lnr lnr-arrow-right"></span></button>-->
<!--						<div style="position: absolute; left: -5000px;">-->
<!--							<input name="b_36c4fd991d266f23781ded980_aefe40901a" tabindex="-1" value="" type="text">-->
<!--						</div>-->

<!--						<div class="info"></div>-->
<!--					</form>-->
<!--				</div>-->
			</div>
		</div>
		<div class="footer-bottom row align-items-center">
			<div class="col-lg-4 col-md-12 footer-social">
				<a href="#"><i class="fa fa-facebook"></i></a>
				<a href="#"><i class="fa fa-twitter"></i></a>
				<a href="#"><i class="fa fa-dribbble"></i></a>
				<a href="#"><i class="fa fa-behance"></i></a>
			</div>
		</div>
	</div>
</footer>
<!-- End Footer Area -->
<!-- ####################### Start Scroll to Top Area ####################### -->
<div id="back-top">
	<a title="Go to Top" href="#"></a>
</div>
<!-- ####################### End Scroll to Top Area ####################### -->

<div th:replace="common/common_foot :: common_foot"></div>
<script th:inline="javascript">
	var context = [[@{/}]];
</script>
<script type="text/javascript">

	$(".btn-submit").click(function () {
	if (checkinput()){
		if($('#inlineCheckbox1').is(':checked')) {
				let index = layer.load(1, {
					shade: [0.1,'#fff'] //0.1透明度的白色背景
				});
				submitForm_COMMON(context + 'calculate/showmc',$(".submitForm"),"#mctr","3DStructMC");
			}
		}
	})

	$(".btn-submit").click(function () {
		if (checkinput()){
		if($('#inlineCheckbox2').is(':checked')) {
			let index = layer.load(1, {
				shade: [0.1,'#fff'] //0.1透明度的白色背景
			});
			submitForm_COMMON(context + 'calculate/vfold',$(".submitForm"),"#vftr","3DStructVF");
			}
		}
	})

	$(".btn-submit").click(function () {
		if (checkinput()){
		if($('#inlineCheckbox3').is(':checked')) {
			let index = layer.load(1, {
				shade: [0.1,'#fff'] //0.1透明度的白色背景
			});
			submitForm_COMMON(context + 'calculate/RNAComposer',$(".submitForm"),"#rtr","3DStructR");
			}
		}
	})

	$(".btn-submit").click(function () {
		if (checkinput()) {
			if ($('#inlineCheckbox4').is(':checked')) {
				let index = layer.load(1, {
					shade: [0.1, '#fff'] //0.1透明度的白色背景
				});
				//submitForm_COMMON(context + 'calculate/showmc',$(".submitForm"),"#3dtr","3DStruct3d");
				$.ajax({
					url: context + 'calculate/3dRNA',
					type: 'POST',
					dataType: 'json', // request type html/json/xml
					data: $(".submitForm").serialize(), // serialize form data
					success: function (e) {
						layer.closeAll();
						if (e.status == 200) {
							console.log(e);
							console.log(e.data);
							console.log("111" + e.data.structPath);
							$("#showStruct").css("display", "block");
							$("#3dtr" + " .prview").attr("href", "http://localhost:8080/toPage?page=prview&url=" + (e.data).prePath);
							$("#3dtr" + " .download").attr("href", (e.data).structPath)
							$("#3dtr" + " .rmsd").html("1."+((e.data).rmsd).substring(2));
							setTimeout(function () {
								rander3D("http://localhost:8080/1AFX.pdb", '3DStruct3d');
							}, 10000);
						} else {
							layer.msg("连接超时，请重新尝试");
						}
					},
					error: function () {
						layer.closeAll();
						layer.msg("连接超时，请重新尝试");
					}
				})
			}
		}
	});


		//提交MCfold表单
		function submitForm_COMMON(url, form,div1,div2) {
			$.ajax({
				url: url,
				type: 'POST',
				dataType: 'json', // request type html/json/xml
				data: form.serialize(), // serialize form data
				success: function (e) {
					layer.closeAll();
					if (e.status == 200) {
						console.log(e);
						console.log(e.data);
						console.log("111" + e.data.structPath);
						$("#showStruct").css("display", "block");
						$(div1 + " .prview").attr("href", (e.data).prePath);
						$(div1 + " .download").attr("href", (e.data).structPath)
						$(div1 + " .rmsd").html((e.data).rmsd);
						setTimeout(function () {
							rander3D(e.data.structPath, div2);
						}, 10000);
					} else {
						layer.closeAll();
						layer.msg("连接超时，请重新尝试");
					}
				},
				error:function () {
					layer.closeAll();
					layer.msg("连接超时，请重新尝试");
				}
			})
		}
		
		function checkinput() {
			let value1=$("textarea[name='Sequence']").val();
			let value2=$("textarea[name='Strcuture']").val();
			if (value1.length!=value2.length) {
				layer.msg('请检查输入选项是否正确');
				return false;
			}else {
			return true;
			}
		}

	function rander3D(url,div){
		var viewer = $3Dmol.createViewer(
				div, //id of div to create canvas in
				{
					defaultcolors: $3Dmol.elementColors.rasmol,
					backgroundColor: 'white'
				}
		);
		$.get(url, function(data) {
			viewer.addModel(data,'pdb');
			viewer.setStyle({stick:{}});
			viewer.center();
			viewer.render();
		});
	}


	function DropDown(el) {
		this.dd = el;
		this.placeholder = this.dd.children('span');
		this.opts = this.dd.find('ul.dropdown > li');
		this.val = '';
		this.index = -1;
		this.initEvents();
	}

	DropDown.prototype = {
		initEvents: function () {
			var obj = this;
			obj.dd.on('click', function (event) {
				$(this).toggleClass('active');
				return false;
			});

			obj.opts.on('click', function () {
				var opt = $(this);
				obj.val = opt.text();
				obj.index = opt.index();
				obj.placeholder.text('预测方法: ' + obj.val);

				if ((opt.text()) == "MC-Fold") {
					showForm("mcform");
				}else if ((opt.text()) == "Vfold3D"){
					showForm("vfoldForm");
				}else if ((opt.text()) == "RNAComposer"){
					showForm("RNAComposerForm");
				}
			});
		},
	}

	$(function () {
		var dd = new DropDown($('#dd'));
		$(document).click(function () {
			// all dropdowns
			$('.wrapper-dropdown-1').removeClass('active');
		});
	});
</script>
</body>

</html>